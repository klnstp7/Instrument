function dtmlXMLLoaderObject(a, b, c, d) { return this.xmlDoc = "", this.async = 2 == arguments.length ? true : c, this.onloadAction = a || null, this.mainObject = b || null, this.waitCall = null, this.rSeed = d || false, this } function callerFunction(a, b) { return this.handler = function (c) { return c || (c = event), a(c, b), true }, this.handler } function getAbsoluteLeft(a) { for (var b = a.offsetLeft, c = a.offsetParent; null != c; ) b += c.offsetLeft, c = c.offsetParent; return b } function getAbsoluteTop(a) { for (var b = a.offsetTop, c = a.offsetParent; null != c; ) b += c.offsetTop, c = c.offsetParent; return b } function convertStringToBoolean(a) { switch ("string" == typeof a && (a = a.toLowerCase()), a) { case "1": case "true": case "yes": case "y": case 1: case true: return true; default: return false } } function getUrlSymbol(a) { return -1 != a.indexOf("?") ? "&" : "?" } function dhtmlDragAndDropObject() { return this.lastLanding = 0, this.dragNode = 0, this.dragStartNode = 0, this.dragStartObject = 0, this.tempDOMU = null, this.tempDOMM = null, this.waitDrag = 0, window.dhtmlDragAndDrop ? window.dhtmlDragAndDrop : (window.dhtmlDragAndDrop = this, this) } function isIE() { return -1 != navigator.appName.indexOf("Microsoft") && -1 == navigator.userAgent.indexOf("Opera") ? true : false } function _dhtmlxError() { return this.catches || (this.catches = []), this } var _isFF, _isIE, _isOpera, _isKHTML, _isMacOS, _FFrv; dtmlXMLLoaderObject.prototype.waitLoadFunction = function (a) { return this.check = function () { null != a.onloadAction && (a.xmlDoc.readyState && 4 != a.xmlDoc.readyState || (a.onloadAction(a.mainObject, null, null, null, a), a.waitCall && (a.waitCall(), a.waitCall = null), a = null)) }, this.check }, dtmlXMLLoaderObject.prototype.getXMLTopNode = function (a) { var b, c, d; return this.xmlDoc.responseXML ? (b = this.xmlDoc.responseXML.getElementsByTagName(a), c = b[0]) : c = this.xmlDoc.documentElement, c ? c : _isIE && !this._retry ? (d = this.xmlDoc.responseText, this._retry = true, this.xmlDoc = new ActiveXObject("Microsoft.XMLDOM"), this.xmlDoc.async = false, this.xmlDoc.loadXML(d), this.getXMLTopNode(a)) : (dhtmlxError.throwError("LoadXML", "Incorrect XML", [this.xmlDoc]), document.createElement("DIV")) }, dtmlXMLLoaderObject.prototype.loadXMLString = function (a) { try { var b = new DOMParser; this.xmlDoc = b.parseFromString(a, "text/xml") } catch (c) { this.xmlDoc = new ActiveXObject("Microsoft.XMLDOM"), this.xmlDoc.async = this.async, this.xmlDoc.loadXML(a) } this.onloadAction(this.mainObject), this.waitCall && (this.waitCall(), this.waitCall = null) }, dtmlXMLLoaderObject.prototype.loadXML = function (a, b, c) { this.rSeed && (a += (-1 != a.indexOf("?") ? "&" : "?") + "a_dhx_rSeed=" + (new Date).valueOf()), this.filePath = a; try { this.xmlDoc = new XMLHttpRequest, this.xmlDoc.open(b ? "POST" : "GET", a, this.async), b && this.xmlDoc.setRequestHeader("Content-type", "application/x-www-form-urlencoded"), this.xmlDoc.onreadystatechange = new this.waitLoadFunction(this), this.xmlDoc.send(null || c) } catch (d) { document.implementation && document.implementation.createDocument ? (this.xmlDoc = document.implementation.createDocument("", "", null), this.xmlDoc.onload = new this.waitLoadFunction(this), this.xmlDoc.load(a)) : (this.xmlDoc = new ActiveXObject("Microsoft.XMLHTTP"), this.xmlDoc.open(b ? "POST" : "GET", a, this.async), b && this.xmlDoc.setRequestHeader("Content-type", "application/x-www-form-urlencoded"), this.xmlDoc.onreadystatechange = new this.waitLoadFunction(this), this.xmlDoc.send(null || c)) } }, dtmlXMLLoaderObject.prototype.destructor = function () { return this.onloadAction = null, this.mainObject = null, this.xmlDoc = null, null }, dhtmlDragAndDropObject.prototype.removeDraggableItem = function (a) { a.onmousedown = null, a.dragStarter = null, a.dragLanding = null }, dhtmlDragAndDropObject.prototype.addDraggableItem = function (a, b) { a.onmousedown = this.preCreateDragCopy, a.dragStarter = b, this.addDragLanding(a, b) }, dhtmlDragAndDropObject.prototype.addDragLanding = function (a, b) { a.dragLanding = b }, dhtmlDragAndDropObject.prototype.preCreateDragCopy = function (a) { return window.dhtmlDragAndDrop.waitDrag ? (window.dhtmlDragAndDrop.waitDrag = 0, document.body.onmouseup = window.dhtmlDragAndDrop.tempDOMU, document.body.onmousemove = window.dhtmlDragAndDrop.tempDOMM, false) : (window.dhtmlDragAndDrop.waitDrag = 1, window.dhtmlDragAndDrop.tempDOMU = document.body.onmouseup, window.dhtmlDragAndDrop.tempDOMM = document.body.onmousemove, window.dhtmlDragAndDrop.dragStartNode = this, window.dhtmlDragAndDrop.dragStartObject = this.dragStarter, document.body.onmouseup = window.dhtmlDragAndDrop.preCreateDragCopy, document.body.onmousemove = window.dhtmlDragAndDrop.callDrag, a && a.preventDefault ? (a.preventDefault(), false) : false) }, dhtmlDragAndDropObject.prototype.callDrag = function (a) { var b, c, d, e; if (a || (a = window.event), dragger = window.dhtmlDragAndDrop, 0 == a.button && _isIE) return dragger.stopDrag(); if (!dragger.dragNode) { if (dragger.dragNode = dragger.dragStartObject._createDragNode(dragger.dragStartNode, a), !dragger.dragNode) return dragger.stopDrag(); dragger.gldragNode = dragger.dragNode, document.body.appendChild(dragger.dragNode), document.body.onmouseup = dragger.stopDrag, dragger.waitDrag = 0, dragger.dragNode.pWindow = window, dragger.initFrameRoute() } dragger.dragNode.parentNode != window.document.body && (b = dragger.gldragNode, dragger.gldragNode.old && (b = dragger.gldragNode.old), b.parentNode.removeChild(b), c = dragger.dragNode.pWindow, _isIE ? (d = document.createElement("Div"), d.innerHTML = dragger.dragNode.outerHTML, dragger.dragNode = d.childNodes[0]) : dragger.dragNode = dragger.dragNode.cloneNode(true), dragger.dragNode.pWindow = window, dragger.gldragNode.old = dragger.dragNode, document.body.appendChild(dragger.dragNode), c.dhtmlDragAndDrop.dragNode = dragger.dragNode), dragger.dragNode.style.left = a.clientX + 15 + (dragger.fx ? -1 * dragger.fx : 0) + (document.body.scrollLeft || document.documentElement.scrollLeft) + "px", dragger.dragNode.style.top = a.clientY + 3 + (dragger.fy ? -1 * dragger.fy : 0) + (document.body.scrollTop || document.documentElement.scrollTop) + "px", e = a.srcElement ? a.srcElement : a.target, dragger.checkLanding(e, a.clientX, a.clientY) }, dhtmlDragAndDropObject.prototype.calculateFramePosition = function (a) { var b, c, d, e; if (window.name) { for (b = parent.frames[window.name].frameElement.offsetParent, c = 0, d = 0; b; ) c += b.offsetLeft, d += b.offsetTop, b = b.offsetParent; if (parent.dhtmlDragAndDrop && (e = parent.dhtmlDragAndDrop.calculateFramePosition(1), c += 1 * e.split("_")[0], d += 1 * e.split("_")[1]), a) return c + "_" + d; this.fx = c, this.fy = d } return "0_0" }, dhtmlDragAndDropObject.prototype.checkLanding = function (a, b, c) { a && a.dragLanding ? (this.lastLanding && this.lastLanding.dragLanding._dragOut(this.lastLanding), this.lastLanding = a, this.lastLanding = this.lastLanding.dragLanding._dragIn(this.lastLanding, this.dragStartNode, b, c)) : a && "BODY" != a.tagName ? this.checkLanding(a.parentNode, b, c) : (this.lastLanding && this.lastLanding.dragLanding._dragOut(this.lastLanding, b, c), this.lastLanding = 0) }, dhtmlDragAndDropObject.prototype.stopDrag = function (a, b) { if (dragger = window.dhtmlDragAndDrop, !b) { dragger.stopFrameRoute(); var c = dragger.lastLanding; dragger.lastLanding = null, c && c.dragLanding._drag(dragger.dragStartNode, dragger.dragStartObject, c) } dragger.lastLanding = null, dragger.dragNode && dragger.dragNode.parentNode == document.body && dragger.dragNode.parentNode.removeChild(dragger.dragNode), dragger.dragNode = 0, dragger.gldragNode = 0, dragger.fx = 0, dragger.fy = 0, dragger.dragStartNode = 0, dragger.dragStartObject = 0, document.body.onmouseup = dragger.tempDOMU, document.body.onmousemove = dragger.tempDOMM, dragger.tempDOMU = null, dragger.tempDOMM = null, dragger.waitDrag = 0 }, dhtmlDragAndDropObject.prototype.stopFrameRoute = function (a) { a && window.dhtmlDragAndDrop.stopDrag(1, 1); for (var b = 0; b < window.frames.length; b++) window.frames[b] != a && window.frames[b].dhtmlDragAndDrop && window.frames[b].dhtmlDragAndDrop.stopFrameRoute(window); parent.dhtmlDragAndDrop && parent != window && parent != a && parent.dhtmlDragAndDrop.stopFrameRoute(window) }, dhtmlDragAndDropObject.prototype.initFrameRoute = function (a, b) { a && (window.dhtmlDragAndDrop.preCreateDragCopy(), window.dhtmlDragAndDrop.dragStartNode = a.dhtmlDragAndDrop.dragStartNode, window.dhtmlDragAndDrop.dragStartObject = a.dhtmlDragAndDrop.dragStartObject, window.dhtmlDragAndDrop.dragNode = a.dhtmlDragAndDrop.dragNode, window.dhtmlDragAndDrop.gldragNode = a.dhtmlDragAndDrop.dragNode, window.document.body.onmouseup = window.dhtmlDragAndDrop.stopDrag, window.waitDrag = 0, !_isIE && b && (!_isFF || 1.8 > _FFrv) && window.dhtmlDragAndDrop.calculateFramePosition()), parent.dhtmlDragAndDrop && parent != window && parent != a && parent.dhtmlDragAndDrop.initFrameRoute(window); for (var c = 0; c < window.frames.length; c++) window.frames[c] != a && window.frames[c].dhtmlDragAndDrop && window.frames[c].dhtmlDragAndDrop.initFrameRoute(window, !a || b ? 1 : 0) }, _isFF = false, _isIE = false, _isOpera = false, _isKHTML = false, _isMacOS = false, -1 != navigator.userAgent.indexOf("Macintosh") && (_isMacOS = true), -1 != navigator.userAgent.indexOf("Safari") || -1 != navigator.userAgent.indexOf("Konqueror") ? _isKHTML = true : -1 != navigator.userAgent.indexOf("Opera") ? (_isOpera = true, _OperaRv = parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera") + 6, 3))) : -1 != navigator.appName.indexOf("Microsoft") ? _isIE = true : (_isFF = true, _FFrv = parseFloat(navigator.userAgent.split("rv:")[1])), dtmlXMLLoaderObject.prototype.doXPath = function (a, b) { var c, d, e, f; if (_isOpera || _isKHTML) return this.doXPathOpera(a, b); if (b || (b = this.xmlDoc.nodeName ? this.xmlDoc : this.xmlDoc.responseXML), _isIE) return b.selectNodes(a); for (c = b, -1 == b.nodeName.indexOf("document") && (b = b.ownerDocument), d = [], e = b.evaluate(a, c, null, XPathResult.ANY_TYPE, null), f = null; f = e.iterateNext(); ) d[d.length] = f; return d }, window.Node && !_isKHTML && (Node.prototype.removeNode = function (a) { var c, b = this; return Boolean(a) ? this.parentNode.removeChild(b) : (c = document.createRange(), c.selectNodeContents(b), this.parentNode.replaceChild(c.extractContents(), b)) }), _dhtmlxError.prototype.catchError = function (a, b) { this.catches[a] = b }, _dhtmlxError.prototype.throwError = function (a, b, c) { return this.catches[a] ? this.catches[a](a, b, c) : this.catches["ALL"] ? this.catches["ALL"](a, b, c) : (alert("Error type: " + arguments[0] + "\nDescription: " + arguments[1]), null) }, window.dhtmlxError = new _dhtmlxError, dtmlXMLLoaderObject.prototype.doXPathOpera = function (a, b) { var c = a.replace(/[\/]+/gi, "/").split("/"), d = null, e = 1; if (!c.length) return []; if ("." == c[0]) d = [b]; else { if ("" != c[0]) return []; d = this.xmlDoc.responseXML.getElementsByTagName(c[e].replace(/\[[^\]]*\]/g, "")), e++ } for (e; e < c.length; e++) d = this._getAllNamedChilds(d, c[e]); return -1 != c[e - 1].indexOf("[") && (d = this._filterXPath(d, c[e - 1])), d }, dtmlXMLLoaderObject.prototype._filterXPath = function (a, b) { var d, c = []; for (b = b.replace(/[^\[]*\[\@/g, "").replace(/[\[\]\@]*/g, ""), d = 0; d < a.length; d++) a[d].getAttribute(b) && (c[c.length] = a[d]); return c }, dtmlXMLLoaderObject.prototype._getAllNamedChilds = function (a, b) { var d, e, c = []; for (d = 0; d < a.length; d++) for (e = 0; e < a[d].childNodes.length; e++) a[d].childNodes[e].tagName == b && (c[c.length] = a[d].childNodes[e]); return c };